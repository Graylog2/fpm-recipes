description "Graylog2 server"
author "TORCH GmbH <hello@torch.sh>"

start on started mongodb
stop on runlevel [!2345]

respawn
respawn limit 10 5

setuid graylog2
setgid graylog2
console log

pre-start script
  . /etc/default/graylog2-server

  if [ "$GRAYLOG2_SERVER_RUN" != "yes" ]; then
    echo "Not starting graylog2-server because GRAYLOG2_SERVER_RUN in /etc/default/graylog2-server is not set to 'yes'"
    exit 1
  fi
end script

exec /usr/bin/java -jar -Dlog4j.configuration=file:///etc/graylog2/server/log4j.xml /usr/share/graylog2-server/graylog2-server.jar -f /etc/graylog2.conf
